  release:
    needs: build
    runs-on: ubuntu-latest
    if: startsWith(github.ref, 'refs/tags/')   # only run when a tag is pushed

    env:
      TAG_NAME: ${{ github.ref_name }}

    steps:
      - name: ðŸ“¥ Download built artifact
        uses: actions/download-artifact@v4
        with:
          name: Modbus_TCP_IP_Tester-${{ env.TAG_NAME }}
          path: ./release

      - name: ðŸš€ Create GitHub Release
        uses: softprops/action-gh-release@v2
        with:
          name: "Modbus TCP/IP Tester ${{ env.TAG_NAME }}"
          tag_name: ${{ env.TAG_NAME }}
          body: |
            ðŸ§° Auto-generated release for version **${{ env.TAG_NAME }}**
            Includes Windows executable build of **Modbus TCP/IP Tester**.
            ### Features:
            - Run as Client or Server
            - CustomTkinter GUI
            - Coils, Inputs, Registers support
            - Dark/Light themes
        env:
          GITHUB_TOKEN: ${{ secrets.GH_PAT || secrets.GITHUB_TOKEN }}

      - name: ðŸ“¤ Upload release asset
        uses: softprops/action-gh-release@v2
        with:
          files: ./release/*.zip
        env:
          GITHUB_TOKEN: ${{ secrets.GH_PAT || secrets.GITHUB_TOKEN }}
